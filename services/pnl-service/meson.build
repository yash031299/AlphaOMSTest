project('pnl-service', 'cpp',
  version: '1.0',
  default_options: ['cpp_std=c++20'])

protobuf_dep = dependency('protobuf')
grpc_dep = dependency('grpc')
spdlog_dep = dependency('spdlog')
nlohmann_json_dep = dependency('nlohmann_json')

proto_srcs = [
  'src/pnl.pb.cc',
  'src/pnl.grpc.pb.cc',
  'src/symbol.pb.cc',
  'src/symbol.grpc.pb.cc',
]

srcs = [
  'src/main.cpp',
  'src/grpc_interface.cpp',
  'src/pnl_engine.cpp',
  'src/equity_calculator.cpp',
] + proto_srcs

inc = include_directories('include')

executable('pnl-service',
  srcs,
  include_directories: inc,
  dependencies: [protobuf_dep, grpc_dep, spdlog_dep, nlohmann_json_dep])
